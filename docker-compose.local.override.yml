services:
  nginx:
    ports:
      - "8080:80"
    volumes:
      - ./nginx/nginx.local.conf:/etc/nginx/nginx.conf:ro
      # Local nginx config (HTTP only) to avoid requiring real TLS certs during local testing
  certbot:
    entrypoint:
      ["/bin/sh", "-c", "trap exit TERM; while :; do sleep 3600; done;"]
    restart: "no"
  # For local testing, ensure Strapi returns correct CORS headers
  # so browser requests from http://localhost:8080 succeed.
  backend:
    environment:
      # Allow localhost origin for local testing (comma-separated values supported)
      CORS_ORIGINS: "http://localhost:8080"
